---
title: "Reproducible Research: Peer Assessment 1"
author: "martin sneath"
date: "For submission 2014/11/16"
output: html_document
  
---


## Loading and preprocessing the data
```{r}
a=read.csv("activity.csv")
b=na.omit(a)
```
## What is mean total number of steps taken per day?
### Make a histogram of the total number of steps taken each day
```{r}
steps=aggregate(b$steps,by=(list(b$date)),FUN=sum)
colnames(steps)=c("Date","Steps")
hist(steps$Steps,main="",xlab="Total steps per day")
```

### Calculate and report the mean and median total number of steps taken per day
```{r}
mean(steps$Steps)
median(steps$Steps)
```
## What is the average daily activity pattern?
```{r}
interval=aggregate(b$steps,by=(list(b$interval)),FUN=mean)
 plot(interval,type="l",xlab="Time (24 hour clock)",ylab="Mean number steps")
```

### Which 5-minute interval, on average across all the days in the dataset, contains the maximum number of steps?
```{r}
interval[which.max(interval$x),]
```

## Imputing missing values
### Calculate and report the total number of missing values in the dataset 
```{r}
sum(is.na(a))
```

### Devise a strategy for filling in all of the missing values in the dataset. The strategy does not need to be sophisticated. You could use the mean for that 5-minute interval, etc.

```{r}
anew=a
for (i in 1:nrow(anew)) {
     if (is.na(anew$steps[i])) {
         anew$steps[i]=interval[match(anew$interval[i],interval),2]
          
     }
}



## Are there differences in activity patterns between weekdays and weekends?
